# THTKGUIのはじめに

Touhou Toolkit（略してthtk）は、東方のゲームリソースファイルを展開および変更するためのツールです。ゲームスクリプト、テクスチャ、GUI要素の抽出および変更できます、ゲーム内のテキスト、敵の移動、攻撃などを指定するレベルスクリプト、Demo Playとゲーム内サウンドの作成が可能です。BGMで作業およびファイルの保存はできません。（紅妖永のMIDI音楽を除く。なぜなら、midファイルは`thbgm.dat`ではなく`thxx.dat`に保存されます）(「xx」は番号、以下同じです）。

Touhou Toolkitは、4つのコンソールアプリケーションで構成されています。（今は5つあります。stdファイルを処理するためのthstd.exeを追加しました、しかし、thtkguiはまだサポートされていません。stdファイルには、3Dバックグラウンド関連ファイルが含まれています）
**thdat**メインのdatファイル（`thxx.dat`）を処理します，**thanm**テクスチャを処理します，**thmsg** - ダイアログを処理します，**thecl** - スクリプトを処理します。現在のバージョンは、紅魔郷から天空璋までのすべての弾幕ゲーム、そして緋想天と非想天則を完全にサポートしています。thdatはPC-98ゲームのdatファイルも処理できますが、結果のファイル（txt以外）はthtkで処理できません。ファイル形式が東方形式のいずれかと互換性がある場合、プログラムは同人ゲームでも動作します。ただし、dat-file名がTouhou dat-file名と異なる場合は警告が表示されます。

東方ツールキットはコンソールアプリケーションであり、thtkguiはグラフィカルユーザーインターフェイスを提供します。最初にすべきことは、thtkフォルダーへのパスを指定することです。また、すべての東方ゲームが存在するフォルダーへのパスを指定することもできます（非必要）。

## 初めての使用

最初に使用するとき（またはthtkパスが `thtkgui.ini`ファイルで指定されていないとき）は、【Touhou Toolkitの場合】を要求するポップアップウィンドウが表示されます。

【ゲームフォルダの場合】に記入してもいい、しないもいい、好きにして。

#### 開始する前に、[THBWikiの関連情報](https://thwiki.cc/-/19kb)を読むことを強くお勧めします。

## THDAT

thtkを使用する最初の段階は、ゲームのメインのdatファイルを展開することです。メインメニュー（左上隅の【ゲーム】）でゲームを選択し、【フォルダ】フィールドでターゲットフォルダを指定し、そしてメインのdatファイルを指定して下さい（通常、その名前は`thxx.dat`。`thbgm.dat`や`score.dat`などのファイルは、thdatでは処理できません）。紅魔郷では、ゲームコンテンツは6つのファイルに分散します。含む：

- `紅魔郷CM.DAT` - 弾幕のスクリプトと利用可能なキャラクターの画像とミニスクリプト

- `紅魔郷ED.DAT` - エンディングとクレジットからのテキストと画像

- `紅魔郷IN.DAT` - サウンドとインターフェイス要素

- `紅魔郷MD.DAT` - MIDI音楽

- `紅魔郷ST.DAT` - 攻撃スクリプト、Stageとスペルカードの背景、敵とBossのスクリプトと写真、対話テキスト

- `紅魔郷TL.DAT` - メニュー画像とテキスト。

#### ボタンの機能

- 【アーカイブを展開】は、datファイルをターゲットフォルダに抽出します。

- 【ファイルリストを所得】は、アーカイブ内のファイルのリストを含むtxtファイルを生成し、プログラムのディレクトリのlistsサブディレクトリに配置します。このリストは、アーカイブの作成中に使用され、その内容を変更すると、ほぼ確実にdatファイルが使用できなくなります。リストは、アーカイブの抽出時に自動的に作成されます。

- 【フォルダからアーカイブを作成】は、作業フォルダーの内容をdatファイルにパックします。対象のdatファイルが既に存在する場合、【バックアップを自動作成】オプションが設定されていると、プロセスの前に名前が変更されます（追加の拡張子、`.bkpxx`が取得されます）。それ以外の場合は、置き換えられます。）

dat-fileに含まれるすべてのファイルは、ターゲットディレクトリに配置されます。Demo Play、写真、音声など、それらの一部には直接アクセスできます。`*.anm`と`*.msg`と`*.ecl`ファイルは、thtkアプリケーションによってさらに処理される必要があります。

#### サポートされているゲーム（Touhou Toolkit release 11を参照）

番号 | ゲーム名 | サポート |備考
:-: | :-: | :-: | :-:
| 1 |東方靈異伝　～ Highly Responsive to Prayers. | できます |  抽出だけ |
| 2 |東方封魔録　～ the Story of Eastern Wonderland.| できます |  抽出だけ |
| 3 |東方夢時空　～ Phantasmagoria of Dim.Dream. | できます |  抽出だけ |
| 4 |東方幻想郷　～ Lotus Land Story.| できます |  抽出だけ |
| 5 |東方怪綺談　～ Mystic Square. | できます |  抽出だけ |
| 6 |東方紅魔郷　～ the Embodiment of Scarlet Devil.| できます | 6つのdatファイルがあります |
| 7 |東方妖々夢　～ Perfect Cherry Blossom.| できます |  |
| 8 |東方永夜抄　～ Imperishable Night.| できます |  |
| 9 |東方花映塚　～ Phantasmagoria of Flower View. | できます |  |
| 95 |東方文花帖　～ Shoot the Bullet. | できます |  |
| 10 |東方風神録　～ Mountain of Faith.| できます |  |
| 103 |黄昏酒場～Uwabami Breakers. | できます |  |
| 105 |東方緋想天　～ Scarlet Weather Rhapsody.| できます |  |
| 11 |東方地霊殿　～ Subterranean Animism. | できます |  |
| 12 |東方星蓮船　～ Undefined Fantastic Object. | できます |  |
| 123 |東方非想天則　～ 超弩級ギニョルの謎を追え | できます |  |
| 125 |ダブルスポイラー　～ 東方文花帖| できます |  |
| 128 |妖精大戦争　～ 東方三月精 | できます |  |
| 13 |東方神霊廟　～ Ten Desires. | できます |  |
| 14 |東方輝針城　～ Double Dealing Character. | できます |  |
| 143 |弾幕アマノジャク　～ Impossible Spell Card.| できます |  |
| 15 |東方紺珠伝　～ Legacy of Lunatic Kingdom. | できます |  |
| 16 |東方天空璋　～ Hidden Star in Four Seasons. | できます |  |
| 16(17) |東方鬼形獣　～ Wily Beast and Weakest Creature.| できます | 天空璋の構成を使用してならできます |

## THANM

.anm拡張子のファイルには、PNG形式のゲームグラフィックスとその動作を説明するスクリプトが含まれています。これらのファイルのアンパックとパックのプロセスは、datファイルと似ていますが、2つの違いがあります。

- プログラムは、anmファイルの名前に一致する推奨ターゲットフォルダーを自動的に生成します。anmアーカイブ内のファイルはフォルダー構造に編成され、展開プロセス中にターゲットフォルダーに再現されます。フォルダの名前または構造を変更すると、anmファイルが使用できなくなります。

- アーカイブ作成プロセスは、単純なファイルリストではなく、「概要」と呼ばれる特別なtxtファイルを使用します。展開時に作成されますが、【概要を所得】ボタンを使用して生成することもできます。説明ファイルの推奨名は自動的に生成されます。

thanmは、再パックせずにアーカイブ内の単一の画像を置き換える方法も提供します。【Entry】フィールドで置換する画像を指定し（【...】ボタンを使用します。最初に説明ファイルを生成する必要があります）、【ファイル】フィールドで置換ファイルを指定し、【アーカイブ内のファイルを置換】を押します。

## THMSG

msgファイルにはダイアログが含まれます。これらのファイルの名前は、`*.msg`（新しいゲームの場合）または`msg * .dat`（古いゲームの場合）です。それぞれが単一のtxtファイルに解凍されます（日本語版はShift JIS、英語版はASCIIでエンコードされています）。【アーカイブを展開】は、指定された「アーカイブ」を指定された「ファイル」に展開し、【ファイルからアーカイブを作成】が逆の処理を行います。プログラムは、msgファイルの名前に一致する推奨ターゲットファイル名を自動的に生成します。

## THECL

eclファイルには、敵の動きや攻撃などを記述するスクリプトが含まれています。その構造と処理は、msgファイルに似ています。[GoogleCodeのthtkページ](https://code.google.com/archive/p/thtk/wikis)には、 これらのファイルで使用されるスクリプト言語の不完全な説明があります。不完整。

または、[THBWikiのスクリプト比較表](https://thwiki.cc/-/198r)を参照できます

## 既知のbug

これらのbugはthtkguiではなく、thtk自体が原因です。

- 花映塚の英語版に問題があります。解凍すると、コンソールにいくつかのエラーが表示され、一部のファイルが適切に解凍されません。これらのファイルから作成されたdatファイルは使用できません。この問題は日本語版には影響しません。

- eclファイルの作成に影響する既知のバグがあります。これにより、アプリケーションは構文エラーをスローし、ターゲットのeclファイルを不可逆的に破損します。このバグは、スペルカードの名前に使用されるエスケープされた二重引用符（記号`\"`）を不適切に処理するアプリケーションが原因です。
このエラーを修正するには、ソースファイルの `\"` のすべてのインスタンスを他の記号またはその組み合わせに置き換える必要があります記号
（`"`を除く）

## 互換性の問題

元のプロジェクトは長年更新されておらず、thtkは第10版（Touhou Toolkit release 10）の後、構文を変更し、release9と互換性のあるなthtkgui理論の最新のthtkバージョンになりました。

このプロジェクトは新しい構文用に更新されているため、thtkリリース10以降のみがサポートされています。

## 元README

今のバージョンのヘルプファイルをMarkdownで書き直し、元のREADME.txtをREADME.mdに置き換えたため、元のREADME.txtの内容をバックアップしました。

>Графический интерфейс для программы Touhou Toolkit от xarnonymous.<br>
>Позволяет пропустить рутинные операции с командной строкой и перейти прямо к моддингу.<br>
>Для подробной информации обратитесь к файлам помощи в папке Help.<br>
Разработка: доброанон с dobrochan.com/to<br>
>Почта: fake.dobrochan@gmail.com<br>
>Автор идеи и главный тестер: sybgamer<br>
>Репозиторий на Гитхабе: github.com/fakedobro/thtkgui<br>
><br>
>A graphical interface for Touhou Toolkit made by xarnonymous.<br>
>Allows to skip routine command line operations and move on straight to >modding.<br>
>For more information refer to help files in Help folder.<br>
>Developer: dobroanon from dobrochan.com/to<br>
>Mail: fake.dobrochan@gmail.com<br>
>Author of idea and main tester: sybgamer<br>
>Repository on GitHub: github.com/fakedobro/thtkgui